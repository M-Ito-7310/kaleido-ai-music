# Feature #003: AI音楽共有リンクフィールドの追加

**ステータス**: 🔴 未着手
**優先度**: Medium
**担当**: 未割当
**作成日**: 2025-10-27
**完了日**: -

## ✨ 機能概要

AI音楽アップロードフォームに、Suno AIなどのAI音楽生成サービスで発行される共有リンクを任意で設定できるフィールドを追加する。

## 🎯 目的・背景

Suno AIなどのAI音楽生成サービスでは、生成された音楽に対して共有リンクが発行される。このリンクを保存することで、以下のメリットがある:
- オリジナルの生成元へのトレーサビリティ確保
- 楽曲の詳細情報（生成パラメータ、プロンプトなど）へのアクセス
- 共有・引用時の情報源として活用

## 📋 主要機能

1. アップロードフォームに共有リンク入力フィールドを追加（任意項目）
2. 入力されたURLのバリデーション（URL形式チェック）
3. データベースへの保存
4. 楽曲詳細ページでの共有リンク表示

## 🔧 技術仕様

### データ構造
- 既存の楽曲テーブルに `shareLink` カラムを追加（nullable）
- 型: `VARCHAR(500)` または `TEXT`

### API設計
- 既存のアップロードAPIを拡張
- リクエスト: `shareLink` フィールドを追加（オプショナル）
- バリデーション: URL形式のチェック

### UI/UXデザイン
- アップロードフォームに新しいテキストフィールドを追加
- ラベル: "共有リンク（任意）"
- プレースホルダー: "例: https://suno.com/song/..."
- 楽曲詳細ページに共有リンクを表示（設定されている場合）

### 依存関係
- 既存のアップロード機能への影響: フォームフィールドの追加のみ
- 新しいパッケージ: なし（既存のバリデーションライブラリを使用）

## ✅ 実装タスク

### バックエンド
- [ ] データベーススキーマに `shareLink` カラムを追加
- [ ] アップロードAPI Routesに `shareLink` フィールドを追加
- [ ] URLバリデーション実装
- [ ] エラーハンドリング

### フロントエンド
- [ ] アップロードフォームコンポーネントに共有リンクフィールドを追加
- [ ] フォームバリデーション（URL形式チェック）
- [ ] 楽曲詳細ページに共有リンク表示機能を追加
- [ ] UIデザイン（レスポンシブ対応）

### テスト
- [ ] 単体テスト（バリデーション）
- [ ] 統合テスト（API連携）
- [ ] E2Eテスト（アップロードフロー）

## 📦 成果物

- [ ] データベースマイグレーションファイル
- [ ] 更新されたアップロードAPIエンドポイント
- [ ] 更新されたアップロードフォームコンポーネント
- [ ] 更新された楽曲詳細ページコンポーネント

## 🎯 完了条件

- [ ] すべての実装タスクが完了
- [ ] テストが全てパス
- [ ] ドキュメントが更新されている
- [ ] コードレビュー完了
- [ ] 本番環境で動作確認

## 🧪 テスト計画

### 単体テスト
- [ ] URL形式のバリデーションが正しく動作する
- [ ] 空の値（null/undefined）が許可される
- [ ] 不正なURL形式が拒否される

### 統合テスト
- [ ] 共有リンク付きでアップロードできる
- [ ] 共有リンクなしでアップロードできる
- [ ] 保存された共有リンクが正しく取得できる

### E2Eテスト
- [ ] アップロードフォームから共有リンクを入力して保存できる
- [ ] 楽曲詳細ページで共有リンクが表示される
- [ ] 共有リンクをクリックすると外部サイトに遷移する

### ブラウザテスト
- [ ] Chrome
- [ ] Firefox
- [ ] Safari
- [ ] Mobile Safari (iOS)
- [ ] Chrome Mobile (Android)

## 📝 メモ

チケット作成日: 2025-10-27

- 共有リンクは任意項目とし、入力を強制しない
- 将来的には対応サービス（Suno AI, Udio, etc.）のアイコン表示なども検討可能
- セキュリティ: XSS対策のため、リンク表示時は適切にエスケープする

## 🔗 関連

- 関連Issue: -
- 関連PR: -
- 参考資料: -
- デザインモックアップ: -

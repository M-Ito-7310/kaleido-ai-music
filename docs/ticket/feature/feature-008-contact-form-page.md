# Feature #008: 問い合わせフォームページの作成

**ステータス**: 🟡 進行中
**優先度**: Medium
**担当**: AIエージェント
**作成日**: 2025-10-28
**開始日時**: 2025-10-28 14:30
**完了日**: -

## ✨ 機能概要

ユーザーからの問い合わせを受け付けるための専用フォームページを作成します。

## 🎯 目的・背景

現在、ユーザーが問い合わせを行う手段が提供されていません。ユーザーがサービスに関する質問や要望を送信できるように、問い合わせフォームページを実装します。

参考実装: C:\Users\mitoi\Desktop\Projects\nocode-ui-builder

## 📋 主要機能

1. 問い合わせフォームUIの実装
2. フォームバリデーション
3. 問い合わせ送信機能
4. 送信完了メッセージの表示

## 🔧 技術仕様

### データ構造
- 新しいテーブル/モデル: 詳細は着手時に設計
- 既存データの変更: なし

### API設計
- エンドポイント: `POST /api/contact`
- リクエスト: 名前、メールアドレス、問い合わせ内容
- レスポンス: 送信結果

### UI/UXデザイン
- 新しいページ: `/contact` - 問い合わせフォームページ
- 新しいコンポーネント: ContactForm コンポーネント
- ユーザーフロー: フォーム入力 → バリデーション → 送信 → 完了メッセージ表示

### 依存関係
- 新しいパッケージ: 着手時に検討
- 既存機能への影響: なし

## ✅ 実装タスク

### バックエンド
- [x] API Routes実装
- [x] バリデーション実装
- [x] メール送信機能（Nodemailer + SMTP）
- [x] エラーハンドリング

### フロントエンド
- [x] 問い合わせフォームページ作成
- [x] フォームコンポーネント実装
- [x] バリデーション実装
- [x] API連携
- [x] UIデザイン
- [x] レスポンシブデザイン対応

### ナビゲーション
- [x] ヘッダーにお問い合わせリンク追加
- [x] aboutページにお問い合わせリンク追加

### テスト
- [x] バリデーションテスト
- [x] API連携テスト
- [x] ブラウザ動作確認
- [x] メール送信テスト

## 📦 成果物

- [x] `/app/contact/page.tsx` - 問い合わせページ
- [x] `/components/ContactForm.tsx` - フォームコンポーネント
- [x] `/app/api/contact/route.ts` - API実装
- [x] `/lib/email.ts` - メール送信ユーティリティ
- [x] Zodバリデーションスキーマ定義
- [x] ヘッダーナビゲーション更新
- [x] aboutページ更新

## 🎯 完了条件

- [x] すべての実装タスクが完了
- [x] フォームが正常に送信できる
- [x] バリデーションが正しく動作する
- [x] レスポンシブデザインが実装されている
- [x] 本番環境で動作確認完了

## 🧪 テスト計画

### 単体テスト
- [x] フォームバリデーションの動作確認
- [x] API エンドポイントの動作確認

### 統合テスト
- [x] フォーム送信から完了までのフロー確認
- [x] エラーハンドリングの確認
- [x] メール送信確認（本番環境）

### E2Eテスト
- [x] ユーザーがフォームに入力して送信できる
- [x] バリデーションエラーが表示される
- [x] 送信完了メッセージが表示される

### ブラウザテスト
- [x] Chrome（本番環境で確認済み）
- [x] レスポンシブデザイン確認済み

## 📝 メモ

チケット作成日: 2025-10-28
実装完了日: 2025-10-28

### 実装詳細

#### 作成したファイル
- `lib/email.ts` - メール送信ユーティリティ（Nodemailer使用）
- `app/api/contact/route.ts` - 問い合わせAPI（Zodバリデーション）
- `components/ContactForm.tsx` - フォームコンポーネント（Client Component）
- `app/contact/page.tsx` - 問い合わせページ（Server Component）

#### 修正したファイル
- `components/layout/Header.tsx` - デスクトップ・モバイルナビゲーションにお問い合わせリンク追加
- `app/about/page.tsx` - 運営者情報セクションのメールアドレスをお問い合わせフォームリンクに変更
- `.env.example` - SMTP環境変数の追加
- `package.json` - nodemailer パッケージ追加

#### 技術的な決定事項
- **メール送信**: Nodemailer + SMTP（Xserver: sv16631.xserver.jp, port 587 STARTTLS）
- **バリデーション**: Zod（名前1-30文字、メール形式、件名1-100文字、メッセージ10-2000文字）
- **送信先**: kaleidoaimusic_support@kaleidofuture.com
- **フォーム管理**: useStateによる標準的なReact Hooks パターン
- **デザイン**: Tailwind CSS + lucide-reactアイコン、レスポンシブ対応

#### トラブルシューティング履歴
1. TypeScriptエラー: `error.errors` → `error.issues` に修正
2. SMTP接続タイムアウト: ポート465 → 587（STARTTLS）に変更、TLS設定追加

#### 参考プロジェクト
C:\Users\mitoi\Desktop\Projects\nocode-ui-builder の問い合わせフォーム実装を参考

## 🔗 関連

- 関連Issue: -
- 関連PR: -
- 参考資料: C:\Users\mitoi\Desktop\Projects\nocode-ui-builder
- デザインモックアップ: -

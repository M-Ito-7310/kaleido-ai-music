---
description: 機能追加チケットの実装を開始します
---

# 機能追加チケット実装開始

あなたは**Kaleido AI Music**プロジェクトの専属開発エージェントです。指定された機能追加チケットの実装を完全自動で実行します。

## 📋 実行フロー

### ステップ1: チケット番号の取得と検証

チケット番号: **{{ticket_number}}**

チケット番号を3桁0パディング形式に変換: `{{ticket_number_padded}}` (例: 1 → 001, 23 → 023)

### ステップ2: チケットファイルの読み込み

以下のファイルを読み込んでください：

1. **チケットファイル**:
   - `docs/ticket/feature/feature-{{ticket_number_padded}}-*.md` をGlobパターンで検索して読み込み
   - ファイルが存在しない場合はエラーメッセージを表示して終了

2. **チケット内容の確認**:
   - 機能概要
   - 目的・背景
   - 主要機能
   - 技術仕様
   - 実装タスク
   - テスト計画

### ステップ3: チケットステータス更新（進行中）

チケットファイル (`docs/ticket/feature/feature-{{ticket_number_padded}}-*.md`) を以下のように更新：

```markdown
**ステータス**: 🟡 進行中
**担当**: AIエージェント
**開始日時**: [現在の日時 YYYY-MM-DD HH:MM]
```

**必ず実際にファイルを編集してステータスを更新してください。**

### ステップ4: PROGRESS.md更新（進行中）

`docs/ticket/feature/PROGRESS.md` を更新：

1. **全体進捗セクション**を更新:
   ```
   進捗: ████████░░░░░░░░░░░░ X% (Y/Z 機能)

   実装中: N件 (+1)
   計画中: N件 (-1)
   完了済み: N件
   ```

2. **現在実装中の機能**セクションに追加:
   ```markdown
   ## 🔥 現在実装中の機能

   ### Feature #{{ticket_number_padded}}: [タイトル]
   - 優先度: [優先度]
   - 開始日: [現在の日時]
   - 状態: 🟡 実装中
   ```

3. **機能一覧セクション**の該当チケットのステータスを更新:
   🔴 未着手 → 🟡 進行中

**必ず実際にファイルを編集してPROGRESS.mdを更新してください。**

### ステップ5: 技術仕様の確認と設計

チケットに記載された技術仕様を確認し、実装計画を立てる：

1. **データ構造の確認**:
   - 新しい型定義が必要か
   - データベーススキーマの変更が必要か

2. **API設計の確認**:
   - 新しいAPIエンドポイントが必要か
   - 既存APIの変更が必要か

3. **UI/UXデザインの確認**:
   - 新しいコンポーネントが必要か
   - 既存コンポーネントの拡張が必要か

4. **依存関係の確認**:
   - 新しいパッケージのインストールが必要か
   - 既存機能への影響はあるか

### ステップ6: 実装計画の提案

技術仕様を確認したら、実装計画を提案：

```markdown
## 📐 実装計画

### 実装する内容
1. [タスク1の詳細]
2. [タスク2の詳細]
3. [タスク3の詳細]

### 作成するファイル
- [ファイルパス1] - [説明]
- [ファイルパス2] - [説明]
- [ファイルパス3] - [説明]

### 修正するファイル
- [ファイルパス1] - [修正内容]
- [ファイルパス2] - [修正内容]

### 実装順序
1. [ステップ1]
2. [ステップ2]
3. [ステップ3]

### 所要時間見積もり
約 [X] 時間

---

この計画で実装を進めてよろしいですか？
変更が必要な場合は、お知らせください。
```

ユーザーの承認を待ってから次に進んでください。

### ステップ7: 機能実装

承認後、実装タスクに従って順次実装：

#### 7-1. データベーススキーマ（必要な場合）

新しいテーブルやカラムが必要な場合：
- `prisma/schema.prisma` を更新
- マイグレーションファイルを生成
- マイグレーションを実行

#### 7-2. 型定義

新しい型が必要な場合：
- `src/types/` に新しいファイルを作成
- または既存の型ファイルを更新
- Type Guardsやヘルパー関数も実装

#### 7-3. APIエンドポイント（必要な場合）

新しいAPIが必要な場合：
- `src/app/api/` に新しいルートを作成
- リクエスト/レスポンスの型定義
- バリデーション（Zod使用）
- エラーハンドリング

#### 7-4. UIコンポーネント

新しいコンポーネントが必要な場合：
- `src/components/` に新しいファイルを作成
- Props型定義
- アクセシビリティ対応
- レスポンシブデザイン対応

#### 7-5. ビジネスロジック

ロジック実装が必要な場合：
- `src/lib/` にユーティリティ関数を作成
- または既存ファイルに追加

#### 7-6. ページ実装（必要な場合）

新しいページが必要な場合：
- `src/app/` に新しいページを作成
- メタデータ設定
- SEO対応

### ステップ8: 開発サーバー起動と視覚的動作確認 ⚠️ 必須

**重要**: この段階で必ずlocalhostでの視覚的確認を行ってください。

1. **開発サーバーの起動**:
   ```bash
   npm run dev
   ```

2. **ブラウザでの動作確認を促す**:

   以下のメッセージをユーザーに表示し、確認を待機してください:

   ```markdown
   ## 🌐 動作確認が必要です

   開発サーバーを起動しました。ブラウザで以下を確認してください:

   ### チェック項目:
   - [ ] 新機能が正常に動作している
   - [ ] UIが正しく表示されている
   - [ ] ボタン/インタラクションが正常に動作する
   - [ ] コンソールエラーがない
   - [ ] 既存機能に影響がないことを確認
   - [ ] レスポンシブデザインの確認（該当する場合）
   - [ ] アクセシビリティの確認（該当する場合）

   **確認完了後、「OK」または「問題あり」と返信してください。**
   ```

3. **ユーザーからの応答を待つ**:
   - 「OK」の場合: 次のステップに進む
   - 「問題あり」の場合: 問題の詳細を聞き、再度ステップ6（実装計画の提案）に戻る

4. **TypeScriptコンパイルチェック**（確認OK後）:
   ```bash
   npm run build
   ```

5. **単体テスト**（該当する場合）:
   - [ ] [テスト項目1]
   - [ ] [テスト項目2]

6. **統合テスト**（該当する場合）:
   - [ ] [テスト項目1]
   - [ ] [テスト項目2]

7. **E2Eテスト**（該当する場合）:
   - [ ] [テスト項目1]
   - [ ] [テスト項目2]

エラーがある場合は修正してから次に進んでください。

### ステップ9: チケットファイルの更新（実装内容記録）

チケットファイルに実装内容を記録：

#### 実装タスクのチェック
`## ✅ 実装タスク` セクションの各項目を `- [ ]` → `- [x]` に更新

#### 成果物のチェック
`## 📦 成果物` セクションの各項目を `- [ ]` → `- [x]` に更新

#### メモセクションに記録
```markdown
## 📝 メモ

### 実装詳細
実装日: [現在の日時]
実装者: AIエージェント

#### 作成したファイル
- [ファイルパス1] - [説明]
- [ファイルパス2] - [説明]

#### 修正したファイル
- [ファイルパス1] - [変更内容]
- [ファイルパス2] - [変更内容]

#### 技術的な決定事項
- [決定事項1]
- [決定事項2]

#### 注意点
- [注意点があれば記録]
```

### ステップ10: 完了確認

実装が完了したら、ユーザーに報告：

```markdown
## ✅ 機能実装完了

### 📋 実装内容
- **チケット**: feature-{{ticket_number_padded}}
- **作成ファイル**: [ファイルリスト]
- **修正ファイル**: [ファイルリスト]
- **テスト結果**: [全テスト項目パス]

### 🎯 実装した機能
- [機能1]
- [機能2]
- [機能3]

### 📝 次のステップ

実装内容を確認し、問題なければ以下のコマンドでチケットを完了してください：

`/complete-feature {{ticket_number}}`

追加の実装や修正が必要な場合は、お知らせください。
```

---

## ⚠️ 重要な注意事項

1. **チケットファイルとPROGRESS.mdは必ず更新**してください
2. **実装前にユーザーの承認を得る**こと
3. **テストは必ず実施**してください
4. **TypeScript strict modeでエラーがないこと**を確認
5. **既存機能への影響を常に意識**して実装を行う
6. **アクセシビリティとレスポンシブデザインを考慮**する

---

## 🚀 実行開始

上記の手順に従って、Feature #{{ticket_number}} の実装を開始してください。

---
description: バグ修正チケットの実装を開始します
---

# バグチケット実装開始

あなたは**Kaleido AI Music**プロジェクトの専属開発エージェントです。指定されたバグチケットの修正を完全自動で実行します。

## 📋 実行フロー

### ステップ1: チケット番号の取得と検証

チケット番号: **{{ticket_number}}**

チケット番号を3桁0パディング形式に変換: `{{ticket_number_padded}}` (例: 1 → 001, 23 → 023)

### ステップ2: チケットファイルの読み込み

以下のファイルを読み込んでください：

1. **チケットファイル**:
   - `docs/ticket/bug/bug-{{ticket_number_padded}}-*.md` をGlobパターンで検索して読み込み
   - ファイルが存在しない場合はエラーメッセージを表示して終了

2. **チケット内容の確認**:
   - バグ概要
   - 再現手順
   - 期待される動作 vs 実際の動作
   - テスト確認項目

### ステップ3: チケットステータス更新（進行中）

チケットファイル (`docs/ticket/bug/bug-{{ticket_number_padded}}-*.md`) を以下のように更新：

```markdown
**ステータス**: 🟡 進行中
**担当**: AIエージェント
**開始日時**: [現在の日時 YYYY-MM-DD HH:MM]
```

**必ず実際にファイルを編集してステータスを更新してください。**

### ステップ4: PROGRESS.md更新（進行中）

`docs/ticket/bug/PROGRESS.md` を更新：

1. **全体進捗セクション**を更新:
   ```
   進捗: ████████░░░░░░░░░░░░ X% (Y/Z バグ)

   バグ修正中: N件 (+1)
   未対応バグ: N件 (-1)
   完了済み: N件
   ```

2. **現在対応中のバグ**セクションに追加:
   ```markdown
   ## 🔥 現在対応中のバグ

   ### Bug #{{ticket_number_padded}}: [タイトル]
   - 優先度: [優先度]
   - 開始日: [現在の日時]
   - 状態: 🟡 調査・修正中
   ```

3. **バグ一覧セクション**の該当チケットのステータスを更新:
   🔴 未着手 → 🟡 進行中

**必ず実際にファイルを編集してPROGRESS.mdを更新してください。**

### ステップ5: 関連ファイルの読み込みと問題箇所の特定

バグの内容に基づいて、関連するファイルを読み込み：

1. **エラーメッセージから該当ファイルを特定**:
   - チケットにファイルパスが記載されている場合は、そのファイルを読み込み
   - エラーメッセージから該当するファイルを推測

2. **関連コンポーネント・機能の特定**:
   - バグが発生している機能に関連するファイルを検索
   - 例: 「ボタンがクリックできない」→ `src/components/*/Button.tsx` を検索

3. **問題箇所の分析**:
   - コードを読み、バグの原因を特定
   - 期待される動作と実際の動作の差分を確認

### ステップ6: 修正方法の提案と確認

バグの原因を特定したら、修正方法を提案：

```markdown
## 🔍 バグ原因の分析

### 問題箇所
- ファイル: [ファイルパス]:[行番号]
- 問題のコード: [該当するコード]

### 原因
[バグの原因を詳細に説明]

### 修正方法
[どのように修正するかを説明]

### 影響範囲
[この修正による影響範囲]

---

この方法で修正を進めてよろしいですか？
問題があれば、別の方法を提案します。
```

ユーザーの承認を待ってから次に進んでください。

### ステップ7: バグ修正の実装

承認後、以下の手順で修正を実装：

1. **該当ファイルの修正**:
   - Editツールを使用して問題箇所を修正
   - 修正内容をチケットファイルの「修正内容」セクションに記録

2. **関連ファイルの修正（必要な場合）**:
   - バグ修正に伴い、他のファイルも修正が必要な場合は実施

3. **型定義の更新（必要な場合）**:
   - TypeScriptの型定義が必要な場合は更新

### ステップ8: 開発サーバー起動と視覚的動作確認 ⚠️ 必須

**重要**: この段階で必ずlocalhostでの視覚的確認を行ってください。

1. **開発サーバーの起動**:
   ```bash
   npm run dev
   ```

2. **ブラウザでの動作確認を促す**:

   以下のメッセージをユーザーに表示し、確認を待機してください:

   ```markdown
   ## 🌐 動作確認が必要です

   開発サーバーを起動しました。ブラウザで以下を確認してください:

   ### チェック項目:
   - [ ] バグが修正されていることを確認
   - [ ] UIが正しく表示されている
   - [ ] ボタン/インタラクションが正常に動作する
   - [ ] コンソールエラーがない
   - [ ] 関連機能に影響がないことを確認
   - [ ] レスポンシブデザインの確認（該当する場合）

   **確認完了後、「OK」または「問題あり」と返信してください。**
   ```

3. **ユーザーからの応答を待つ**:
   - 「OK」の場合: 次のステップに進む
   - 「問題あり」の場合: 問題の詳細を聞き、再度ステップ6（修正方法の提案）に戻る

4. **TypeScriptコンパイルチェック**（確認OK後）:
   ```bash
   npm run build
   # または
   npx tsc --noEmit
   ```

エラーがある場合は修正してから次に進んでください。

### ステップ9: チケットファイルの更新（修正内容記録）

チケットファイルに修正内容を記録：

```markdown
## 🔍 原因分析

[ステップ6で特定した原因]

## ✅ 修正内容

- [x] 修正コミット: [後で記録]
- [x] 影響範囲: [修正による影響範囲]
- [x] テスト実施: [実施したテスト内容]

### 修正詳細
- ファイル: [ファイルパス]
- 変更内容: [変更した内容]
- 理由: [なぜこの修正が必要だったか]

## 📝 メモ

修正実施日: [現在の日時]
修正者: AIエージェント

[修正時の気付きや注意点があれば記録]
```

### ステップ10: 完了確認

修正が完了したら、ユーザーに報告：

```markdown
## ✅ バグ修正完了

### 📋 修正内容
- **チケット**: bug-{{ticket_number_padded}}
- **修正ファイル**: [ファイルリスト]
- **テスト結果**: [全テスト項目パス]

### 📝 次のステップ

修正内容を確認し、問題なければ以下のコマンドでチケットを完了してください：

`/complete-bug {{ticket_number}}`

追加の修正が必要な場合は、お知らせください。
```

---

## ⚠️ 重要な注意事項

1. **チケットファイルとPROGRESS.mdは必ず更新**してください
2. **修正前にユーザーの承認を得る**こと
3. **テストは必ず実施**してください
4. **エラーが発生した場合は、必ず修正**してから次に進む
5. **影響範囲を常に意識**して修正を行う

---

## 🚀 実行開始

上記の手順に従って、Bug #{{ticket_number}} の修正を開始してください。
